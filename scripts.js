words = ["Accident", "Achat", "Acné", "Action", "Adolescent", "Afrique", "Aiguille", "Allumer", "Alpes", "Alphabet", "Altitude", "Amérique", "Ami", "Amour", "Ampoule", "Anniversaire", "Appétit", "Araignée", "Arbre", "Arc", "Arc-en-ciel", "Argent", "Arme", "Armée", "Ascenseur", "Asie", "Assis", "Astronaute", "Atchoum", "Athlète", "Atlantide", "Aube", "Australie", "Avec", "Aventure", "Avion", "Avocat", "Bac", "Baguette", "Bain", "Baiser", "Balai", "Balle", "Ballon", "Bambou", "Banane", "Bannir", "Barbe", "Barrière", "Bas", "Basket", "Bateau", "Bâton", "Batterie", "Bébé", "Beethoven", "Bête", "Biberon", "Bière", "Blanc", "Blé", "Bleu", "Bob", "Boisson", "Boîte", "Bombe", "Bonbon", "Bonnet", "Bord", "Bordeaux", "Botte", "Boue", "Bougie", "Boule", "Bouteille", "Bouton", "Branche", "Bras", "Bravo", "Bretagne", "Brise", "Brosse", "Bruit", "Brume", "Brun", "Bûche", "Bulle", "Bureau", "But", "Cabane", "Cabine", "Cacher", "Cadeau", "Cafard", "Café", "Caisse", "Calculer", "Calme", "Caméra", "Camion", "Camping", "Canada", "Canard", "Canette", "Canine", "Cap", "Capitalisme", "Car", "Carotte", "Carré", "Carte", "Carton", "Casque", "Casser", "Cassette", "Cauchemar", "Cause", "Ceinture", "Cellule", "Cercle", "Chaîne", "Chair", "Chaise", "Champ", "Champion", "Chant", "Chapeau", "Charbon", "Charge", "Chasse", "Chat", "Château", "Chaud", "Chaussure", "Chauve", "Chef", "Chemise", "Chêne", "Cher", "Cheval", "Chevalier", "Cheveu", "Chien", "Chiffre", "Chine", "Chocolat", "Chômage", "Ciel", "Cil", "Cinéma", "Cire", "Cirque", "Citron", "Clé", "Clou", "Clown", "Coach", "Coccinelle", "Code", "Cœur", "Col", "Colle", "Colline", "Colonne", "Cône", "Confort", "Continu", "Contre", "Conversation", "Copain", "Coq", "Coquillage", "Corbeau", "Corde", "Corps", "Côte", "Coude", "Couloir", "Coup", "Cour", "Courant", "Courrier", "Cours", "Course", "Court", "Couteau", "Couvert", "Couverture", "Cowboy", "Crac", "Crayon", "Crème", "Critique", "Crochet", "Croix", "Croûte", "Cuillère", "Cuir", "Cuisine", "Culotte", "Cycle", "Dard", "Debout", "Défaut", "Dehors", "Démocratie", "Dent", "Dentiste", "Dessin", "Devoir", "Diamant", "Dictionnaire", "Dieu", "Dinosaure", "Discours", "Disque", "Dix", "Docteur", "Doigt", "Domino", "Dormir", "Droit", "Eau", "Échec", "Échelle", "Éclair", "École", "Écran", "Écraser", "Écrit", "Église", "Égout", "Électricité", "Éléphant", "Élève", "Elfe", "Empreinte", "Enceinte", "Épice", "Épine", "Erreur", "Espace", "Espion", "Essence", "État", "Été", "Étoile", "Étranger", "Éventail", "Évolution", "Explosoin", "Extension", "Face", "Fan", "Farce", "Fatigue", "Fauteuil", "Femme", "Fenêtre", "Fer", "Fête", "Feu", "Feuille", "Fidèle", "Fil", "Fille", "Flamme", "Flèche", "Fleur", "Fleuve", "Fond", "Football", "Forêt", "Forger", "Foudre", "Fouet", "Four", "Fourmi", "Froid", "Fromage", "Front", "Fruit", "Fuir", "Futur", "Garçon", "Gâteau", "Gauche", "Gaz", "Gazon", "Gel", "Genou", "Glace", "Gomme", "Gorge", "Goutte", "Grand", "Grèce", "Grenouille", "Grippe", "Gris", "Gros", "Groupe", "Guitare", "Hasard", "Haut", "Hélicoptère", "Herbe", "Heureux", "Histoire", "Hiver", "Hôtel", "Hugo", "Huile", "Humide", "Humour", "Indice", "Internet", "Inviter", "Italie", "Jacques", "Jambe", "Jambon", "Jardin", "Jaune", "Jean", "Jeanne", "Jet", "Jeu", "Jogging", "Jour", "Journal", "Jupiter", "Kilo", "Kiwi", "Laine", "Lait", "Langue", "Lapin", "Latin", "Laver", "Lecteur", "Léger", "Lent", "Lettre", "Lien", "Ligne", "Linge", "Lion", "Lit", "Livre", "Loi", "Long", "Louis", "Loup", "Lumière", "Lundi", "Lune", "Lunette", "Machine", "Macho", "main", "Maison", "Maîtresse", "Mal", "Maladie", "Maman", "Mammouth", "Manger", "Marais", "Marc", "Marche", "Mariage", "Marie", "Mariée", "Marque", "Marseille", "Masse", "Mer", "Messe", "Mètre", "Métro", "Miaou", "Micro", "Mieux", "Mille", "Mine", "Miroir", "Moderne", "Moitié", "Monde", "Monstre", "Montagne", "Montre", "Mort", "Moteur", "Moto", "Mou", "Mouche", "Moulin", "Moustache", "Mouton", "Mur", "Muscle", "Musique", "Mystère", "Nage", "Nature", "Neige", "Neutre", "New York", "Nez", "Nid", "Ninja", "Niveau", "Noël", "Nœud", "Noir", "Nous", "Nuage", "Nuit", "Numéro", "Œil", "Œuf", "Oiseau", "Olympique", "Ombre", "Ongle", "Oral", "Orange", "Ordinateur", "Ordre", "Ordure", "Oreille", "Organe", "Orgueil", "Ours", "Outil", "Ouvert", "Ovale", "Pain", "Palais", "Panneau", "Pantalon", "Pantin", "Papa", "Papier", "Papillon", "Paradis", "Parc", "Paris", "Parole", "Partie", "Passe", "Pâte", "Patin", "Patte", "Paul", "Payer", "Pêche", "Peinture", "Pendule", "Penser", "Personne", "Petit", "Peur", "Philosophe", "Photo", "Phrase", "Piano", "Pièce", "Pied", "Pierre", "Pile", "Pilote", "Pince", "Pioche", "Pion", "Pirate", "Pire", "Piscine", "Place", "Plafond", "Plage", "Plaie", "Plan", "Planche", "Planète", "Plante", "Plastique", "Plat", "Plat", "Plomb", "Plonger", "Pluie", "Poche", "Poète", "Poids", "Poing", "Point", "Poivre", "Police", "Politique", "Pollen", "Polo", "Pomme", "Pompe", "Pont", "Population", "Port", "Porte", "Portefeuille", "Positif", "Poste", "Poubelle", "Poule", "Poupée", "Pousser", "Poussière", "Pouvoir", "Préhistoire", "Premier", "Présent", "Presse", "Prier", "Princesse", "Prise", "Privé", "Professeur", "Psychologie", "Public", "Pull", "Punk", "Puzzle", "Pyjama", "Quatre", "Quinze", "Race", "Radio", "Raisin", "Rap", "Rayé", "Rayon", "Réfléchir", "Reine", "Repas", "Reptile", "Requin", "Rêve", "Riche", "Rideau", "Rien", "Rire", "Robinet", "Roche", "Roi", "Rond", "Rose", "Roue", "Rouge", "Rouille", "Roux", "Russie", "Sable", "Sabre", "Sac", "Sain", "Saison", "Sale", "Salle", "Salut", "Samu", "Sandwich", "Sang", "Sapin", "Satellite", "Saumon", "Saut", "Savoir", "Schtroumpf", "Science", "Scout", "Sec", "Seine", "Sel", "Sept", "Serpent", "Serrer", "Sexe", "Shampooing", "Siècle", "Siège", "Sieste", "Silhouette", "Sirène", "Ski", "Soleil", "Sommeil", "Son", "Sonner", "Sorcière", "Sourd", "Souris", "Sport", "Star", "Station", "Stylo", "Sur", "Surface", "Sushi", "Swing", "Tableau", "Tache", "Taille", "Tante", "Tapis", "Tard", "Taxi", "Téléphone", "Télévision", "Temple", "Temps", "Tennis", "Tête", "Thé", "Tigre", "Tintin", "Tissu", "Titre", "Titre", "Toast", "Toilette", "Tokyo", "Tombe", "Ton", "Top", "Touche", "Toujours", "Tour", "Tournoi", "Tout", "Trace", "Train", "Traîner", "Transport", "Travail", "Trésor", "Triangle", "Triste", "Trône", "Troupeau", "Tsar", "Tube", "Tuer", "Tuer", "Tupperware", "Tuyau", "Twitter", "Type", "Université", "Vache", "Vache", "Vague", "Vaisselle", "Valeur", "Ver", "Verdict", "Verre", "Vers", "Vert", "Veste", "Viande", "Vide", "Vie", "Vieux", "Ville", "Vin", "Vingt", "Violon", "Vipère", "Vision", "Vite", "Vive", "Vœu", "Voile", "Voisin", "Voiture", "Vol", "Volume", "Vote", "Vouloir", "Voyage", "Zen", "Zéro", "Zodiaque", "Zone", "Zoo"]
words_caps = ["ACCIDENT", "ACHAT", "ACNE", "ACTION", "ADOLESCENT", "AFRIQUE", "AIGUILLE", "ALLUMER", "ALPES", "ALPHABET", "ALTITUDE", "AMERIQUE", "AMI", "AMOUR", "AMPOULE", "ANNIVERSAIRE", "APPETIT", "ARAIGNEE", "ARBRE", "ARC", "ARC-EN-CIEL", "ARGENT", "ARME", "ARMEE", "ASCENSEUR", "ASIE", "ASSIS", "ASTRONAUTE", "ATCHOUM", "ATHLETE", "ATLANTIDE", "AUBE", "AUSTRALIE", "AVEC", "AVENTURE", "AVION", "AVOCAT", "BAC", "BAGUETTE", "BAIN", "BAISER", "BALAI", "BALLE", "BALLON", "BAMBOU", "BANANE", "BANNIR", "BARBE", "BARRIERE", "BAS", "BASKET", "BATEAU", "BATON", "BATTERIE", "BEBE", "BEETHOVEN", "BETE", "BIBERON", "BIERE", "BLANC", "BLE", "BLEU", "BOB", "BOISSON", "BOITE", "BOMBE", "BONBON", "BONNET", "BORD", "BORDEAUX", "BOTTE", "BOUE", "BOUGIE", "BOULE", "BOUTEILLE", "BOUTON", "BRANCHE", "BRAS", "BRAVO", "BRETAGNE", "BRISE", "BROSSE", "BRUIT", "BRUME", "BRUN", "BUCHE", "BULLE", "BUREAU", "BUT", "CABANE", "CABINE", "CACHER", "CADEAU", "CAFARD", "CAFE", "CAISSE", "CALCULER", "CALME", "CAMERA", "CAMION", "CAMPING", "CANADA", "CANARD", "CANETTE", "CANINE", "CAP", "CAPITALISME", "CAR", "CAROTTE", "CARRE", "CARTE", "CARTON", "CASQUE", "CASSER", "CASSETTE", "CAUCHEMAR", "CAUSE", "CEINTURE", "CELLULE", "CERCLE", "CHAINE", "CHAIR", "CHAISE", "CHAMP", "CHAMPION", "CHANT", "CHAPEAU", "CHARBON", "CHARGE", "CHASSE", "CHAT", "CHATEAU", "CHAUD", "CHAUSSURE", "CHAUVE", "CHEF", "CHEMISE", "CHENE", "CHER", "CHEVAL", "CHEVALIER", "CHEVEU", "CHIEN", "CHIFFRE", "CHINE", "CHOCOLAT", "CHOMAGE", "CIEL", "CIL", "CINEMA", "CIRE", "CIRQUE", "CITRON", "CLE", "CLOU", "CLOWN", "COACH", "COCCINELLE", "CODE", "COEUR", "COL", "COLLE", "COLLINE", "COLONNE", "CONE", "CONFORT", "CONTINU", "CONTRE", "CONVERSATION", "COPAIN", "COQ", "COQUILLAGE", "CORBEAU", "CORDE", "CORPS", "COTE", "COUDE", "COULOIR", "COUP", "COUR", "COURANT", "COURRIER", "COURS", "COURSE", "COURT", "COUTEAU", "COUVERT", "COUVERTURE", "COWBOY", "CRAC", "CRAYON", "CREME", "CRITIQUE", "CROCHET", "CROIX", "CROUTE", "CUILLERE", "CUIR", "CUISINE", "CULOTTE", "CYCLE", "DARD", "DEBOUT", "DEFAUT", "DEHORS", "DEMOCRATIE", "DENT", "DENTISTE", "DESSIN", "DEVOIR", "DIAMANT", "DICTIONNAIRE", "DIEU", "DINOSAURE", "DISCOURS", "DISQUE", "DIX", "DOCTEUR", "DOIGT", "DOMINO", "DORMIR", "DROIT", "EAU", "ECHEC", "ECHELLE", "ECLAIR", "ECOLE", "ECRAN", "ECRASER", "ECRIT", "EGLISE", "EGOUT", "ELECTRICITE", "ELEPHANT", "ELEVE", "ELFE", "EMPREINTE", "ENCEINTE", "EPICE", "EPINE", "ERREUR", "ESPACE", "ESPION", "ESSENCE", "ETAT", "ETE", "ETOILE", "ETRANGER", "EVENTAIL", "EVOLUTION", "EXPLOSOIN", "EXTENSION", "FACE", "FAN", "FARCE", "FATIGUE", "FAUTEUIL", "FEMME", "FENETRE", "FER", "FETE", "FEU", "FEUILLE", "FIDELE", "FIL", "FILLE", "FLAMME", "FLECHE", "FLEUR", "FLEUVE", "FOND", "FOOTBALL", "FORET", "FORGER", "FOUDRE", "FOUET", "FOUR", "FOURMI", "FROID", "FROMAGE", "FRONT", "FRUIT", "FUIR", "FUTUR", "GARCON", "GATEAU", "GAUCHE", "GAZ", "GAZON", "GEL", "GENOU", "GLACE", "GOMME", "GORGE", "GOUTTE", "GRAND", "GRECE", "GRENOUILLE", "GRIPPE", "GRIS", "GROS", "GROUPE", "GUITARE", "HASARD", "HAUT", "HELICOPTERE", "HERBE", "HEUREUX", "HISTOIRE", "HIVER", "HOTEL", "HUGO", "HUILE", "HUMIDE", "HUMOUR", "INDICE", "INTERNET", "INVITER", "ITALIE", "JACQUES", "JAMBE", "JAMBON", "JARDIN", "JAUNE", "JEAN", "JEANNE", "JET", "JEU", "JOGGING", "JOUR", "JOURNAL", "JUPITER", "KILO", "KIWI", "LAINE", "LAIT", "LANGUE", "LAPIN", "LATIN", "LAVER", "LECTEUR", "LEGER", "LENT", "LETTRE", "LIEN", "LIGNE", "LINGE", "LION", "LIT", "LIVRE", "LOI", "LONG", "LOUIS", "LOUP", "LUMIERE", "LUNDI", "LUNE", "LUNETTE", "MACHINE", "MACHO", "MAIN", "MAISON", "MAITRESSE", "MAL", "MALADIE", "MAMAN", "MAMMOUTH", "MANGER", "MARAIS", "MARC", "MARCHE", "MARIAGE", "MARIE", "MARIEE", "MARQUE", "MARSEILLE", "MASSE", "MER", "MESSE", "METRE", "METRO", "MIAOU", "MICRO", "MIEUX", "MILLE", "MINE", "MIROIR", "MODERNE", "MOITIE", "MONDE", "MONSTRE", "MONTAGNE", "MONTRE", "MORT", "MOTEUR", "MOTO", "MOU", "MOUCHE", "MOULIN", "MOUSTACHE", "MOUTON", "MUR", "MUSCLE", "MUSIQUE", "MYSTERE", "NAGE", "NATURE", "NEIGE", "NEUTRE", "NEW YORK", "NEZ", "NID", "NINJA", "NIVEAU", "NOEL", "NOEUD", "NOIR", "NOUS", "NUAGE", "NUIT", "NUMERO", "OEIL", "OEUF", "OISEAU", "OLYMPIQUE", "OMBRE", "ONGLE", "ORAL", "ORANGE", "ORDINATEUR", "ORDRE", "ORDURE", "OREILLE", "ORGANE", "ORGUEIL", "OURS", "OUTIL", "OUVERT", "OVALE", "PAIN", "PALAIS", "PANNEAU", "PANTALON", "PANTIN", "PAPA", "PAPIER", "PAPILLON", "PARADIS", "PARC", "PARIS", "PAROLE", "PARTIE", "PASSE", "PATE", "PATIN", "PATTE", "PAUL", "PAYER", "PECHE", "PEINTURE", "PENDULE", "PENSER", "PERSONNE", "PETIT", "PEUR", "PHILOSOPHE", "PHOTO", "PHRASE", "PIANO", "PIECE", "PIED", "PIERRE", "PILE", "PILOTE", "PINCE", "PIOCHE", "PION", "PIRATE", "PIRE", "PISCINE", "PLACE", "PLAFOND", "PLAGE", "PLAIE", "PLAN", "PLANCHE", "PLANETE", "PLANTE", "PLASTIQUE", "PLAT", "PLAT", "PLOMB", "PLONGER", "PLUIE", "POCHE", "POETE", "POIDS", "POING", "POINT", "POIVRE", "POLICE", "POLITIQUE", "POLLEN", "POLO", "POMME", "POMPE", "PONT", "POPULATION", "PORT", "PORTE", "PORTEFEUILLE", "POSITIF", "POSTE", "POUBELLE", "POULE", "POUPEE", "POUSSER", "POUSSIERE", "POUVOIR", "PREHISTOIRE", "PREMIER", "PRESENT", "PRESSE", "PRIER", "PRINCESSE", "PRISE", "PRIVE", "PROFESSEUR", "PSYCHOLOGIE", "PUBLIC", "PULL", "PUNK", "PUZZLE", "PYJAMA", "QUATRE", "QUINZE", "RACE", "RADIO", "RAISIN", "RAP", "RAYE", "RAYON", "REFLECHIR", "REINE", "REPAS", "REPTILE", "REQUIN", "REVE", "RICHE", "RIDEAU", "RIEN", "RIRE", "ROBINET", "ROCHE", "ROI", "ROND", "ROSE", "ROUE", "ROUGE", "ROUILLE", "ROUX", "RUSSIE", "SABLE", "SABRE", "SAC", "SAIN", "SAISON", "SALE", "SALLE", "SALUT", "SAMU", "SANDWICH", "SANG", "SAPIN", "SATELLITE", "SAUMON", "SAUT", "SAVOIR", "SCHTROUMPF", "SCIENCE", "SCOUT", "SEC", "SEINE", "SEL", "SEPT", "SERPENT", "SERRER", "SEXE", "SHAMPOOING", "SIECLE", "SIEGE", "SIESTE", "SILHOUETTE", "SIRENE", "SKI", "SOLEIL", "SOMMEIL", "SON", "SONNER", "SORCIERE", "SOURD", "SOURIS", "SPORT", "STAR", "STATION", "STYLO", "SUR", "SURFACE", "SUSHI", "SWING", "TABLEAU", "TACHE", "TAILLE", "TANTE", "TAPIS", "TARD", "TAXI", "TELEPHONE", "TELEVISION", "TEMPLE", "TEMPS", "TENNIS", "TETE", "THE", "TIGRE", "TINTIN", "TISSU", "TITRE", "TITRE", "TOAST", "TOILETTE", "TOKYO", "TOMBE", "TON", "TOP", "TOUCHE", "TOUJOURS", "TOUR", "TOURNOI", "TOUT", "TRACE", "TRAIN", "TRAINER", "TRANSPORT", "TRAVAIL", "TRESOR", "TRIANGLE", "TRISTE", "TRONE", "TROUPEAU", "TSAR", "TUBE", "TUER", "TUER", "TUPPERWARE", "TUYAU", "TWITTER", "TYPE", "UNIVERSITE", "VACHE", "VACHE", "VAGUE", "VAISSELLE", "VALEUR", "VER", "VERDICT", "VERRE", "VERS", "VERT", "VESTE", "VIANDE", "VIDE", "VIE", "VIEUX", "VILLE", "VIN", "VINGT", "VIOLON", "VIPERE", "VISION", "VITE", "VIVE", "VOEU", "VOILE", "VOISIN", "VOITURE", "VOL", "VOLUME", "VOTE", "VOULOIR", "VOYAGE", "ZEN", "ZERO", "ZODIAQUE", "ZONE", "ZOO"]

colorsDict = {
	'green': "#83F889",
	'black': "#f94d4d",//"#B3B3B3",
	'yellow': "#FCFCCD",
	'darkgreen': "#066A01",
	'lost': '#020202',
}
colorsHelpDict = {
	'green': 'Mot vert à faire deviner à votre partenaire.',
	'black': 'Mot noir. Si votre partenaire sur ces mots, vous perdez.',
	'yellow': 'Mot neutre. ',
	'darkgreen': 'Ce mot a correctement été deviné.',
	'lost': 'Vous avez cliqué ou votre partenaire a cliqué sur un mot noir. Vous avvez perdu.',
	'X': "Vous avez déjà proposé ce mot. Il n'est pas dans les mots que votre partenaire doit vous faire deviner."
}
// green = "#83F889";
// black = "#B3B3B3";
// yellow = "#FCFCCD";
indicesLeftElt = document.getElementById("indicesLeft");
var indicesLeftNb = 9;


var player = -1;
var wordsDict = {};

var words_25 = [];
var common_words = [];
var words_player = {};
words_player[0] = [];
words_player[1] = [];
var blackwords_player = {};
blackwords_player[0] = [];
blackwords_player[1] = [];
// var words_player0 = [];
// var words_player1 = [];
// var blackwords_player0 = [];
// var blackwords_player1 = [];
var clues = {};
// var updates = {};
// updates['game'] = 1;
// firebase.database().ref().update(updates);

// console.log(gameval)
function help(){
	var helpdiv = document.getElementById('helpdiv');
	var i = 0;
	for (key in colorsHelpDict){
		var button = document.createElement('button');
		if (key!='X') {
			button.innerHTML="MOT";
			button.style.background = colorsDict[key];
		}
		else button.innerHTML= "X - MOT - X";
		var divbutton = document.createElement('div');
		// divbutton.setAttribute("class","grid-item");
		divbutton.appendChild(button);
		var divtxt = document.createElement('div');
		divtxt.setAttribute("class","grid-item");
		divtxt.innerText = colorsHelpDict[key];
		helpdiv.appendChild(divbutton);
		helpdiv.appendChild(divtxt);
		// var cell = document.createElement('td');
		// cell.setAttribute("width","25%")
		// cell.appendChild(button);
		// line.appendChild(cell);
		// cell = document.createElement('td');
		// cell.innerText = colorsHelpDict[key];
		// line.appendChild(cell);
		// line.setAttribute("class","spaceUnder");
		// helpdiv.appendChild(line);
		i++;
	}
}

function callPopup() {
    var popup = document.getElementById("myPopup");
    popup.classList.toggle("show");
}

function callPopup(){
	if (confirm("Etes vous sur de vouloir arreter la partie ?")) reset();
}

function reset(){
	updateGame = {};
	updateGame['game'] = null;
	firebase.database().ref().update(updateGame);	
	var updateGame = {};
	updateGame['game/on'] = 0;
	updateGame['game/nbClues'] = 0;
	firebase.database().ref().update(updateGame);	
	location.reload();
}

function update(){
	return firebase.database().ref('game/on').once('value').then(function(snapshot) {
		var gameval = snapshot.val();
		console.log("game on = "+gameval);
	});
}

function startGame(){	
	var _ = window.setInterval(updateClues, 2000);

	firebase.database().ref('game/on').once('value').then(function(snapshot) {
		var gameval = snapshot.val();
		console.log("game on = "+gameval);
		var board = document.getElementById("board");
		board.style.display = "block";
		var starButton = document.getElementById("starButton");
		starButton.style.display = "none";
		if (gameval==0){
			player = 0;
			wordsDict = initGamePlayer0();	
			var updateOn = {};
			updateOn['game/on'] = 1;
			firebase.database().ref().update(updateOn);
			var updates = {};
			for (var key in wordsDict){
				updates['game/words/'+key] = wordsDict[key];
			}	
			firebase.database().ref().update(updates);		
		}
		else{
			var count = 0;
			player = 1;
			firebase.database().ref('game/words').once('value').then(function(snapshot){
				snapshot.forEach(function(child){
					if (child.key != "on") {
						wordsDict[child.key] = child.val();
						count++;
						if (count == 25) initGameplayer1(wordsDict);
					}
				})
			})
			// console.log(wordsDict);
		}
		// updateIndicesLeft();
	});
}


function getRandomSubarray(arr, size) {
	var shuffled = arr.slice(0), i = arr.length, temp, index;
	while (i--) {
		index = Math.floor((i + 1) * Math.random());
		temp = shuffled[index];
		shuffled[index] = shuffled[i];
		shuffled[i] = temp;
	}
	return shuffled.slice(0, size);
};

var openFile = function(event) {
	var input = event.target;
	var reader = new FileReader();
	reader.onload = function(){
		var text = reader.result;
		var node = document.getElementById('output');
		node.innerText = text;
		console.log(reader.result.substring(0, 200));
	};
	reader.readAsText(input.files[0]);
};

function arr_diff(a1, a2) {
	var a = [], diff = [];
	for (var i = 0; i < a1.length; i++) {
		a[a1[i]] = true;
	}
	for (var i = 0; i < a2.length; i++) {
		if (a[a2[i]]) {
		delete a[a2[i]];
		} else {
			a[a2[i]] = true;
		}
	}
	for (var k in a) {
		diff.push(k);
	}
	return diff;
}

function displayWords(wordlist){
	var wordsToButtons = {};
	for (i=0;i<5;i++){
		for (j=0;j<5;j++){
			button = document.getElementById(i.toString()+j.toString());
			button.innerHTML = wordlist[i*5+j];
			wordsToButtons[wordlist[i*5+j]] = button;
		}
	}
	return wordsToButtons;
}

function shuffle(a) {
	for (let i = a.length - 1; i > 0; i--) {
		const j = Math.floor(Math.random() * (i + 1));
		[a[i], a[j]] = [a[j], a[i]];
	}
	return a;
}

function colorWords(wordsDict,player,wordsToButtons){
	for (key in wordsDict){
		var colors = wordsDict[key].split(',');
		wordsToButtons[key].style.background = colorsDict[colors[player]];
	}
}

function include(array,value){
	var bool = false;
	array.forEach(function(elt){
		if (elt == value) bool =  true;
	})
	return bool;
}

function updateIndicesLeft(){
	indicesLeftElt.innerHTML = indicesLeftNb;
}

function initGamePlayer0(){

	words_25 = getRandomSubarray(words_caps,25);
	wordsToButtons = displayWords(words_25);

	words_25 = shuffle(words_25);
	common_words = words_25.slice(0,3);
	var words_22 = words_25.slice(3);
	words_player[0] = common_words.concat(words_25.slice(3,8));
	words_player[1] = common_words.concat(words_25.slice(8,13));
	blackwords_player[0] = words_25.slice(12,15);
	blackwords_player[1] = [words_25[3],words_25[13],words_25[15]];

	var wordsDict =  {};
	words_25.forEach(function(w){
		if (include(words_player[0],w)) {
			if (include(words_player[1],w)) wordsDict[w] = "green,green";
			else if (include(blackwords_player[1],w)) wordsDict[w] = "green,black";
			else wordsDict[w] = "green,yellow";
		}
		else if (include(blackwords_player[0],w)){
			if (include(words_player[1],w)) wordsDict[w] = "black,green";
			else if (include(blackwords_player[1],w)) wordsDict[w] = "black,black";
			else wordsDict[w] = "black,yellow";
		}
		else {
			if (include(words_player[1],w)) wordsDict[w] = "yellow,green";
			else if (include(blackwords_player[1],w)) wordsDict[w] = "yellow,black";
			else wordsDict[w] = "yellow,yellow";
		}
	});
	console.log(wordsDict)
	colorWords(wordsDict,0,wordsToButtons)
	return wordsDict;
}

function initGameplayer1(wordsDict){
	console.log("initGameplayer1");
	console.log(wordsDict);
	console.log(Object.keys(wordsDict).length)
	for (var key in wordsDict){
		words_25.push(key);
		var colors = wordsDict[key].split(",");
		if (colors[0] == "green") {
			words_player[0].push(key);
			if (colors[1] == "green") common_words.push(key);
		}
		if (colors[1] == "green") words_player[1].push(key);
		if (colors[0] == "black") blackwords_player[0].push(key);
		if (colors[1] == "black") blackwords_player[1].push(key);
	}

	wordsToButtons = displayWords(words_25);

	console.log(words_25);
	console.log(common_words);
	console.log(words_player);
	console.log(blackwords_player);
	colorWords(wordsDict,1,wordsToButtons)
}

function addClue(div,txt,newClue){
	var p = document.createElement("p");
	if (newClue) {
		var b = document.createElement("b");
		p.appendChild(b);
		b.appendChild(document.createTextNode(txt));
	}
	else p.appendChild(document.createTextNode(txt));
	div.appendChild(p);
}

function displayClues(nbClues,cluesDict,nbNewClues){
	var div = document.getElementById('cluelist');
	div.innerHTML = "";
	for (var i=nbClues-1; i>=0; i--){
		addClue(div,cluesDict[i],nbClues-i<=nbNewClues);
	}
}

function updateClues(){	
	// console.log("In updateClues");
	var nbDisplayedClues = document.getElementById("cluelist").childElementCount;
	// console.log("nbOlClues = "+nbDisplayedClues)
	firebase.database().ref('game/nbClues').once('value').then(function(snapshot) {
		var nbClues = snapshot.val();
		if (nbDisplayedClues != nbClues){
			clues = {};
			var count = 0;
			firebase.database().ref('game/clues').once('value').then(function(snapshot){
				snapshot.forEach(function(child){
					clues[child.key] = child.val();
					count ++;
					if (count == nbClues) displayClues(nbClues,clues,count-nbDisplayedClues);
				})
			})
		}
	})
}

function sendClue(){
	var clueElt = document.getElementById("clue");
	var clue = clueElt.value;	
	clueElt.value = "";
	console.log(clue);

	firebase.database().ref('game/nbClues').once('value').then(function(snapshot) {
		var nbClues = snapshot.val();
		nbClues ++;
		var updateGame = {};
		updateGame['game/clues/'+(nbClues-1)] = clue;
		updateGame['game/nbClues'] = nbClues;
		firebase.database().ref().update(updateGame).then(updateClues());
	})
}

function checkWord(id){
	var button = document.getElementById(id);
	var w = button.innerHTML;
	// console.log(w);
	var opponent = Math.abs(player-1);
	console.log(words_player[opponent]);
	console.log(blackwords_player[opponent]);
	if (words_player[opponent].indexOf(w) != -1) button.style.background = colorsDict["darkgreen"];
	else if (blackwords_player[opponent].indexOf(w) != -1) button.style.background = colorsDict['lost'];
	else button.innerHTML = "X - "+w+" - X";
}